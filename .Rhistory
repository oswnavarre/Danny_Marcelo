Medición = as.numeric(factor(Fecha))
) |>
select(Medición,
Tratamiento,
Dosis,
Textura,
SPAD,
ALTURA)
datos$Dosis <- factor(datos$Dosis,
levels =c(0,1,2,3))
datos_largos <- datos |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
datos_new <- datos |>
drop_na() |>
mutate(
Medición = as.numeric(factor(Fecha))
) |>
select(Medición,
Dosis,
Textura,
SPAD,
ALTURA)
datos$Dosis <- factor(datos$Dosis,
levels =c(0,1,2,3))
datos_largos <- datos |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
datos_largos <- datos |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
datos_largos <- datos_new |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
datos_largos <- datos_new |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
View(datos)
datos_largos <- datos |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
datos <- read_excel("datos.xlsx")
datos_largos <- datos |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
datos <- datos |>
drop_na() |>
mutate(
Medición = as.numeric(factor(Fecha))
) |>
select(Medición,
Tratamiento,
Vigor,
Dosis,
Textura,
SPAD,
ALTURA)
datos_largos <- datos |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
View(datos_largos)
View(datos_largos)
datos_new <- datos |>
mutate(
Vigor = NULL,)
datos_new <- datos |>
drop_na() |>
mutate(
Medición = as.numeric(factor(Fecha))
) |>
select(Medición,
Dosis,
Textura,
SPAD,
ALTURA)
datos_new <- datos |>
drop_na() |>
mutate(
Medición = as.numeric(factor(Fecha))
) |>
select(Medición,
Dosis,
Textura,
SPAD,
ALTURA)
datos_new <- datos_new |>
drop_na() |>
mutate(
Medición = as.numeric(factor(Fecha))
) |>
select(Medición,
Dosis,
Textura,
SPAD,
ALTURA)
datos$Dosis <- factor(datos$Dosis,
levels =c(0,1,2,3))
datos_largos <- datos_new |>
pivot_longer(
5:7,
names_to = "Variable",
values_to = "Valor"
)
datos_largos <- datos_new |>
pivot_longer(
4:6,
names_to = "Variable",
values_to = "Valor"
)
View(datos_largos)
stats_vars_new <- datos_largos |>
group_by(Medición, Dosis,  Variable) |>
summarise(
Media = mean(Valor),
Desv = sd(Valor)
)
stats_vars_dosis <- datos_largos |>
group_by(Medición, Dosis,  Variable) |>
summarise(
Media = mean(Valor),
Desv = sd(Valor)
)
variables <- unique(datos_largos$Variable)
for(i in seq_along(variables)){
df <- stats_vars |>
filter(Variable == variables[i])
etiqueta <- paste0(dicc_vars[i,2])
g2 <- ggplot(df, aes(x = Medición, y = Media, col = Dosis)) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = unique(df$Medición)) +
facet_wrap(. ~ Vigor, nrow = 1) +
labs(x = "Medición", y = etiqueta) +
theme_apa() +
theme(
legend.position = "bottom",
text = element_text(family = "Arial"),
axis.text = element_text(size = 12),
axis.title = element_text(size = 12, face = "bold"),
legend.text = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10)
)
nombre <- paste0("evolucion_",variables[i],".png")
ggsave(nombre,g2,width = 8, height = 4)
}
ggsave(nombre,g2,width = 8, height = 4)
g2 <- ggplot(df, aes(x = Medición, y = Media, col = Dosis)) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = unique(df$Medición)) +
facet_wrap(. ~ , nrow = 1) +
g2 <- ggplot(df, aes(x = Medición, y = Media, col = Dosis)) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = unique(df$Medición)) +
facet_wrap(. ~ nrow = 1) +
g2 <- ggplot(df, aes(x = Medición, y = Media, col = Dosis)) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = unique(df$Medición)) +
facet_wrap(. nrow = 1) +
g2 <- ggplot(df, aes(x = Medición, y = Media, col = Dosis)) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = unique(df$Medición)) +
facet_wrap(. ~ Tratamiento, nrow = 1) +
labs(x = "Medición", y = etiqueta) +
theme_apa() +
theme(
legend.position = "bottom",
text = element_text(family = "Arial"),
axis.text = element_text(size = 12),
axis.title = element_text(size = 12, face = "bold"),
legend.text = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10)
)
nombre <- paste0("evolucion_",variables[i],".png")
ggsave(nombre,g2,width = 8, height = 4)
valoresp_aov_dosis <- data.frame(
Variable = NA,
valorp = NA,
Medición = NA
)
valoresp_aov_vigor_dosis <- data.frame(
Variable = NA,
valorp = NA,
Medición = NA
)
grupos_dosis <- data.frame(
Medición = NA,
Variable = NA,
Dosis = NA,
Grupos = NA
)
mediciones <- unique(datos$Medición)
for(j in seq_along(mediciones)){
for(i in seq_along(variables)){
datos_grafico_new <- datos_largos |>
filter(Variable == variables[i] & Medición == mediciones[j])
variable_lab = dicc_vars[i,2]
etiqueta_grafico = paste(variable_lab)
nombre_grafico = paste0("graficos/",mediciones[j],"_",variables[i],".png")
gvar <- ggplot(datos_grafico, aes(x = Dosis, y = Valor, color = Tratamiento)) +
geom_boxplot() +
theme_apa() +
ylab(etiqueta_grafico) +
theme(
legend.position = "bottom",
axis.text.y = element_text(color = "black", family = "Arial",size=12),
axis.text.x = element_text(color = "black", family = "Arial",size=12),
axis.title.y = element_text(color = "black", family = "Arial",size=12),
legend.text = element_text(color = "black", family = "Arial",size=12),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"),
axis.line.x.top = element_line(color = "black"),
axis.line.y.right = element_line(color = "black")
)
ggsave(nombre_grafico,gvar, width = 4, height = 4 )
aov_var <- aov(Valor ~ Dosis + Vigor:Dosis,
data = datos_grafico)
tbl_aov_var <- anova(aov_var)
valsp_aov_dosis <- data.frame(
Medición = mediciones[j],
Variable = variables[i],
valorp =  tbl_aov_var[2,5]
)
valsp_aov_vigor_dosis <- data.frame(
Medición = mediciones[j],
Variable = variables[i],
valorp =  tbl_aov_var[3,5]
)
valoresp_aov_dosis <- bind_rows(valoresp_aov_dosis, valsp_aov_dosis)
valoresp_aov_vigor_dosis <- bind_rows(valoresp_aov_vigor_dosis, valsp_aov_vigor_dosis)
tukey_dosis <- HSD.test(aov_var, "Dosis")
grps_dosis <- tukey_dosis$groups
grps_dosis <- grps_dosis |>
rownames_to_column(var = "Dosis") |>
select(-2) |>
mutate(
Medición = mediciones[j],
Variable = variables[i]) |>
rename(
Grupos = groups
)
grupos_dosis <- rbind(grupos_dosis,grps_dosis)
var2 <- datos_grafico |>
group_by(Dosis) |>
summarise(grupos = mean(Valor))
nombre_grafico_interaccion <- paste0("graficos/interaccion_",mediciones[j],"_",variables[i],".bmp")
grafico_int <- ggplot(var2, aes(x = Dosis, y = grupos, color = Tratamiento) ) +
geom_line(aes(group = Tratamiento)) +
geom_point() +
ylab(etiqueta_grafico) +
xlab("Dosis") + theme_apa() +
theme(
legend.position = "bottom",
axis.text.y = element_text(color = "black", family = "Arial",size=12),
axis.text.x = element_text(color = "black", family = "Arial",size=12),
axis.title.y = element_text(color = "black", family = "Arial",size=12),
legend.text = element_text(color = "black", family = "Arial",size=12),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"),
axis.line.x.top = element_line(color = "black"),
axis.line.y.right = element_line(color = "black")
)
ggsave(nombre_grafico_interaccion,grafico_int,width = 4, height = 4)
}
}
dicc_vars <- read_excel("datos.xlsx", sheet = "vars")
g2 <- ggplot(df, aes(x = Medición, y = Media, col = Dosis)) +
geom_point() +
geom_line() +
scale_x_continuous(breaks = unique(df$Medición)) +
facet_wrap(. ~ Tratamiento, nrow = 1) +
labs(x = "Medición", y = etiqueta) +
theme_apa() +
theme(
legend.position = "bottom",
text = element_text(family = "Arial"),
axis.text = element_text(size = 12),
axis.title = element_text(size = 12, face = "bold"),
legend.text = element_text(size = 12, face = "bold"),
plot.title = element_text(size = 14, face = "bold"),
plot.subtitle = element_text(size = 12),
plot.caption = element_text(size = 10)
)
mediciones <- unique(datos$Medición)
for(j in seq_along(mediciones)){
for(i in seq_along(variables)){
datos_grafico_new <- datos_largos |>
filter(Variable == variables[i] & Medición == mediciones[j])
variable_lab = dicc_vars[i,2]
etiqueta_grafico = paste(variable_lab)
nombre_grafico = paste0("graficos/",mediciones[j],"_",variables[i],".png")
gvar <- ggplot(datos_grafico, aes(x = Dosis, y = Valor, color = Tratamiento)) +
geom_boxplot() +
theme_apa() +
ylab(etiqueta_grafico) +
theme(
legend.position = "bottom",
axis.text.y = element_text(color = "black", family = "Arial",size=12),
axis.text.x = element_text(color = "black", family = "Arial",size=12),
axis.title.y = element_text(color = "black", family = "Arial",size=12),
legend.text = element_text(color = "black", family = "Arial",size=12),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"),
axis.line.x.top = element_line(color = "black"),
axis.line.y.right = element_line(color = "black")
)
ggsave(nombre_grafico,gvar, width = 4, height = 4 )
aov_var <- aov(Valor ~ Dosis + Vigor:Dosis,
data = datos_grafico)
tbl_aov_var <- anova(aov_var)
valsp_aov_dosis <- data.frame(
Medición = mediciones[j],
Variable = variables[i],
valorp =  tbl_aov_var[2,5]
)
valsp_aov_vigor_dosis <- data.frame(
Medición = mediciones[j],
Variable = variables[i],
valorp =  tbl_aov_var[3,5]
)
valoresp_aov_dosis <- bind_rows(valoresp_aov_dosis, valsp_aov_dosis)
valoresp_aov_vigor_dosis <- bind_rows(valoresp_aov_vigor_dosis, valsp_aov_vigor_dosis)
tukey_dosis <- HSD.test(aov_var, "Dosis")
grps_dosis <- tukey_dosis$groups
grps_dosis <- grps_dosis |>
rownames_to_column(var = "Dosis") |>
select(-2) |>
mutate(
Medición = mediciones[j],
Variable = variables[i]) |>
rename(
Grupos = groups
)
grupos_dosis <- rbind(grupos_dosis,grps_dosis)
var2 <- datos_grafico |>
group_by(Dosis) |>
summarise(grupos = mean(Valor))
nombre_grafico_interaccion <- paste0("graficos/interaccion_",mediciones[j],"_",variables[i],".bmp")
grafico_int <- ggplot(var2, aes(x = Dosis, y = grupos, color = Tratamiento) ) +
geom_line(aes(group = Tratamiento)) +
geom_point() +
ylab(etiqueta_grafico) +
xlab("Dosis") + theme_apa() +
theme(
legend.position = "bottom",
axis.text.y = element_text(color = "black", family = "Arial",size=12),
axis.text.x = element_text(color = "black", family = "Arial",size=12),
axis.title.y = element_text(color = "black", family = "Arial",size=12),
legend.text = element_text(color = "black", family = "Arial",size=12),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"),
axis.line.x.top = element_line(color = "black"),
axis.line.y.right = element_line(color = "black")
)
ggsave(nombre_grafico_interaccion,grafico_int,width = 4, height = 4)
}
}
var2 <- datos_grafico |>
group_by(Dosis) |>
summarise(grupos = mean(Valor))
gvar <- ggplot(datos_grafico, aes(x = Dosis, y = Valor, color = Tratamiento)) +
geom_boxplot() +
theme_apa() +
ylab(etiqueta_grafico) +
theme(
legend.position = "bottom",
axis.text.y = element_text(color = "black", family = "Arial",size=12),
axis.text.x = element_text(color = "black", family = "Arial",size=12),
axis.title.y = element_text(color = "black", family = "Arial",size=12),
legend.text = element_text(color = "black", family = "Arial",size=12),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"),
axis.line.x.top = element_line(color = "black"),
axis.line.y.right = element_line(color = "black")
)
gvar <- ggplot(datos_grafico_new, aes(x = Dosis, y = Valor, color = Tratamiento)) +
geom_boxplot() +
theme_apa() +
ylab(etiqueta_grafico) +
theme(
legend.position = "bottom",
axis.text.y = element_text(color = "black", family = "Arial",size=12),
axis.text.x = element_text(color = "black", family = "Arial",size=12),
axis.title.y = element_text(color = "black", family = "Arial",size=12),
legend.text = element_text(color = "black", family = "Arial",size=12),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"),
axis.line.x.top = element_line(color = "black"),
axis.line.y.right = element_line(color = "black")
)
ggsave(nombre_grafico,gvar, width = 4, height = 4 )
aov_var <- aov(Valor ~ Dosis + Vigor:Dosis,
data = datos_grafico)
aov_var <- aov(Valor ~ Dosis + Vigor:Dosis,
data = datos_grafico_new)
valsp_aov_dosis <- data.frame(
Medición = mediciones[j],
Variable = variables[i],
valorp =  tbl_aov_var[2,5]
)
ggsave(nombre_grafico,gvar, width = 4, height = 4 )
aov_var <- aov(Valor ~ Dosis + Vigor:Dosis,
data = datos_grafico_new)
aov_var <- aov(Valor ~ Dosis + Vigor:Dosis,
data = datos_grafico_new)
etiqueta_grafico = paste(variable_lab)
valsp_aov_dosis <- data.frame(
Medición = mediciones[j],
Variable = variables[i],
valorp =  tbl_aov_var[2,5]
)
aov_var <- aov(Valor ~ Dosis + ,
aov_var <- aov(Valor ~ Dosis,
data = datos_grafico_new)
tbl_aov_var <- anova(aov_var)
valsp_aov_dosis <- data.frame(
Medición = mediciones[j],
Variable = variables[i],
valorp =  tbl_aov_var[2,5]
)
valsp_aov_vigor_dosis <- data.frame(
Medición = mediciones[j],
Variable = variables[i],
valorp =  tbl_aov_var[3,5]
)
valoresp_aov_dosis <- bind_rows(valoresp_aov_dosis, valsp_aov_dosis)
valoresp_aov_vigor_dosis <- bind_rows(valoresp_aov_vigor_dosis, valsp_aov_vigor_dosis)
tukey_dosis <- HSD.test(aov_var, "Dosis")
grps_dosis <- tukey_dosis$groups
grps_dosis <- grps_dosis |>
rownames_to_column(var = "Dosis") |>
select(-2) |>
mutate(
Medición = mediciones[j],
Variable = variables[i]) |>
rename(
Grupos = groups
)
grupos_dosis <- rbind(grupos_dosis,grps_dosis)
var2 <- datos_grafico |>
group_by(Dosis) |>
summarise(grupos = mean(Valor))
var2 <- datos_grafico_new |>
group_by(Dosis) |>
summarise(grupos = mean(Valor))
nombre_grafico_interaccion <- paste0("graficos/interaccion_",mediciones[j],"_",variables[i],".bmp")
grafico_int <- ggplot(var2, aes(x = Dosis, y = grupos, color = Tratamiento) ) +
geom_line(aes(group = Tratamiento)) +
geom_point() +
ylab(etiqueta_grafico) +
xlab("Dosis") + theme_apa() +
theme(
legend.position = "bottom",
axis.text.y = element_text(color = "black", family = "Arial",size=12),
axis.text.x = element_text(color = "black", family = "Arial",size=12),
axis.title.y = element_text(color = "black", family = "Arial",size=12),
legend.text = element_text(color = "black", family = "Arial",size=12),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"),
axis.line.x.top = element_line(color = "black"),
axis.line.y.right = element_line(color = "black")
)
ggsave(nombre_grafico_interaccion,grafico_int,width = 4, height = 4)
ggsave(nombre_grafico_interaccion,grafico_int,width = 4, height = 4)
grafico_int <- ggplot(var2, aes(x = Dosis, y = grupos, color = Tratamiento) ) +
geom_line(aes(group = Tratamiento)) +
geom_point() +
ylab(etiqueta_grafico) +
xlab("Dosis") + theme_apa() +
theme(
legend.position = "bottom",
axis.text.y = element_text(color = "black", family = "Arial",size=12),
axis.text.x = element_text(color = "black", family = "Arial",size=12),
axis.title.y = element_text(color = "black", family = "Arial",size=12),
legend.text = element_text(color = "black", family = "Arial",size=12),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"),
axis.line.x.top = element_line(color = "black"),
axis.line.y.right = element_line(color = "black")
)
ggsave(nombre_grafico_interaccion,grafico_int,width = 4, height = 4)
